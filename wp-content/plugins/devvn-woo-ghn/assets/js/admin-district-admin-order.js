!function(a){a(document).ready(function(){function i(b){0==b?a("body").removeClass("ghn_loading"):a("body").addClass("ghn_loading"),k()}function j(b,c){var d=b.hubID,e=a("#ghn_action_nonce").val();e||(e=c.data("nonce"));var f=a(".order_id",c).val(),g=a(".ghn_all_goicuoc",c),j=a(".ghn_all_phuphi_list",c),k=a(".ghn_all_phuphi",c),l=a("#ghn_order_weight",c).val(),n=a("#ghn_order_length",c).val(),o=a("#ghn_order_width",c).val(),p=a("#ghn_order_height",c).val(),q=a("#ghn_CouponCode",c).val(),r=a("#ghn_InsuranceFee",c).val();h||a.ajax({type:"post",dataType:"json",url:admin_ghn_array.ajaxurl,data:{action:"ghn_change_hub",hubid:d,order_id:f,weight:l,length:n,width:o,height:p,CouponCode:q,InsuranceFee:r,nonce:e},context:this,beforeSend:function(){i()},success:function(a){j.html(""),k.removeClass("ghn_show"),a.success?(g.html(a.data),m(c)):(g.html(""),alert(a.data)),i(!1)},error:function(){i(!1),g.html(""),j.html(""),k.removeClass("ghn_show")}})}function k(b){b||(b=a(".ghn_creat_popup "));var c=a(".ghn_PaymentTypeID:checked",b).val(),d=a("#ghn_tienthuho",b),e=a('input[name="ghn_services"]:checked',b).data("fee")||0,f=d.data("subtotal")||0;1==c?d.val(f+e):2==c&&d.val(f)}function l(){for(var a="",b="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",c=0;c<24;c++)a+=b.charAt(Math.floor(Math.random()*b.length));return a}function m(b){var c=a("#ghn_creatorder_hub",b).val(),d=a(".total_order_api",b),e=a(".order_id",b).val();if(a('input[name="ghn_services"]:checked',b).val()&&c){var f=a(".ghn_isPickAtStation:checked",b).val(),g=!1,h=[];a('input[name="ghn_extras[]"]:checked',b).each(function(b){h[b]=a(this).val(),16==a(this).val()&&(g=!0)}),1==f&&h.push("53337"),a.ajax({type:"post",dataType:"json",url:admin_ghn_array.ajaxurl,data:{action:"ghn_calculatefee",weight:a("#ghn_order_weight",b).val(),length:a("#ghn_order_length",b).val(),width:a("#ghn_order_width",b).val(),height:a("#ghn_order_height",b).val(),serviceID:a('input[name="ghn_services"]:checked',b).val()||0,couponcode:a("#ghn_CouponCode",b).val(),orderCosts:h,insuranceFee:g?a("#ghn_InsuranceFee",b).val():0,hubID:c,orderid:e},context:this,beforeSend:function(){i()},success:function(c){if(d.html(""),c.success&&c.data){var e=c.data.result_html,f=c.data.allow_creat_order;d.html(e),a(".allow_creat_order",b).val(f?"1":"0"),a(window).trigger("resize")}i(!1)},error:function(){d.html(""),i(!1)}})}else d.html("");return!1}accounting.settings={currency:{symbol:"\u0111",format:"%v %s",decimal:",",thousand:".",precision:0},number:{precision:0,thousand:".",decimal:","}},a.fn.extend({vnformat:function(b){var c;c="val"==b?a(this).val():a(this).text();var d="";return d=c.replace(/\xe0|\xe1|\u1ea1|\u1ea3|\xe3|\xe2|\u1ea7|\u1ea5|\u1ead|\u1ea9|\u1eab|\u0103|\u1eb1|\u1eaf|\u1eb7|\u1eb3|\u1eb5|\xc0|\xc1|\u1ea0|\u1ea2|\xc3|\xc2|\u1ea6|\u1ea4|\u1eac|\u1ea8|\u1eaa|\u0102|\u1eb0|\u1eae|\u1eb6|\u1eb2|\u1eb4/g,"a").replace(/\u0111|\u0110/g,"d").replace(/\u1ef3|\xfd|\u1ef5|\u1ef7|\u1ef9|\u1ef2|\xdd|\u1ef4|\u1ef6|\u1ef8/g,"y").replace(/\xf9|\xfa|\u1ee5|\u1ee7|\u0169|\u01b0|\u1eeb|\u1ee9|\u1ef1|\u1eed|\u1eef|\xd9|\xda|\u1ee4|\u1ee6|\u0168|\u01af|\u1eea|\u1ee8|\u1ef0|\u1eec|\u1eee/g,"u").replace(/\xf2|\xf3|\u1ecd|\u1ecf|\xf5|\xf4|\u1ed3|\u1ed1|\u1ed9|\u1ed5|\u1ed7|\u01a1|\u1edd|\u1edb|\u1ee3|\u1edf|\u1ee1|\xd2|\xd3|\u1ecc|\u1ece|\xd5|\xd4|\u1ed2|\u1ed0|\u1ed8|\u1ed4|\u1ed6|\u01a0|\u1edc|\u1eda|\u1ee2|\u1ede|\u1ee0/g,"o").replace(/\xe8|\xe9|\u1eb9|\u1ebb|\u1ebd|\xea|\u1ec1|\u1ebf|\u1ec7|\u1ec3|\u1ec5|\xc8|\xc9|\u1eb8|\u1eba|\u1ebc|\xca|\u1ec0|\u1ebe|\u1ec6|\u1ec2|\u1ec4/g,"e").replace(/\xec|\xed|\u1ecb|\u1ec9|\u0129|\xcc|\xcd|\u1eca|\xcc|\u0128/g,"i")}}),a.expr[":"].icontains=function(b,c,d){return a(b).vnformat().toUpperCase().indexOf(d[3].toUpperCase())>=0},a(".search_city").on("keyup",function(){var b=a(this).vnformat("val"),c=a(this).closest(".devvn_hubs_table");list=a(".ghn_all_state_checkbox_item",c),list.hide();var d=a(".ghn_all_state_checkbox_item label:icontains('"+b+"')",c);d.closest(".ghn_all_state_checkbox_item").find(".ghn_all_state_checkbox_item").andSelf().show()});var b={formatNoMatches:admin_ghn_array.formatNoMatches},c=loading_shipping=!1;a("#_billing_state").select2(b),a("#_billing_city").select2(b),a("body #_billing_state").live("select2:select",function(b){console.log("a"),a("#_billing_city option").val("");var d=b.val;d||(d=a("body #_billing_state option:selected").val()),d&&!c&&(c=!0,a.ajax({type:"post",dataType:"json",url:admin_ghn_array.ajaxurl,data:{action:"load_diagioihanhchinh",matp:d},context:this,beforeSend:function(){a("#_billing_city").html("").select2();var b=new Option("Loading...","");a("#_billing_city").append(b)},success:function(b){c=!1,a("#_billing_city").html("").select2();var d=new Option("Ch\u1ecdn x\xe3/ph\u01b0\u1eddng/th\u1ecb tr\u1ea5n","");if(b.success){var e=b.data;d=new Option("Ch\u1ecdn qu\u1eadn/huy\u1ec7n",""),a("#_billing_city").append(d),a.each(e,function(b,c){d=new Option(c.WardName,c.WardCode),a("#_billing_city").append(d)})}}}))}),a("#_shipping_state").select2(b),a("#_shipping_city").select2(b),a("body #_shipping_state").live("select2:select",function(b){a("#_shipping_city option").val("");var c=b.val;c||(c=a("#_shipping_state option:selected").val()),c&&!loading_shipping&&(loading_shipping=!0,a.ajax({type:"post",dataType:"json",url:admin_ghn_array.ajaxurl,data:{action:"load_diagioihanhchinh",matp:c},context:this,beforeSend:function(){a("#_shipping_city").html("").select2();var b=new Option("Loading...","");a("#_shipping_city").append(b)},success:function(b){loading_shipping=!1,a("#_shipping_city").html("").select2();var c=new Option("Ch\u1ecdn x\xe3/ph\u01b0\u1eddng/th\u1ecb tr\u1ea5n","");if(b.success){var d=b.data,c=new Option("Ch\u1ecdn qu\u1eadn/huy\u1ec7n","");a("#_shipping_city").append(c),a.each(d,function(b,c){var d=new Option(c.WardName,c.WardCode);a("#_shipping_city").append(d)})}}}))}),a(".hub_DistrictID").length>0&&a(".hub_DistrictID").select2();var e=!1;a(".devvn_ghn_updatehubs").on("click",function(){if(!e){var b=a(this).closest(".devvn_hubs_table"),c={},d=a('[class^="hub_"]',b);d.each(function(){a(this).is("select")?c[a(this).data("name")]=a("option:selected",this).val():"checkbox"==a(this).prop("type")?a(this).is(":checked")&&(c[a(this).data("name")]=a(this).val()):c[a(this).data("name")]=a(this).val()});var f=a("#nonce_update").val();a.ajax({type:"post",dataType:"json",url:admin_ghn_array.ajaxurl,data:{action:"update_hubs",data:c,nonce:f},context:this,beforeSend:function(){a(".spinner",b).addClass("is-active"),e=!0},success:function(c){c.success?location.reload():alert(c.data),a(".spinner",b).removeClass("is-active"),e=!1}})}return!1});var f=!1;a(".devvn_ghn_addhubs").on("click",function(){if(!f){var b=a(this).closest(".devvn_hubs_table"),c={},d=a('[class^="hub_"]',b);d.each(function(){a(this).is("select")?c[a(this).data("name")]=a("option:selected",this).val():"checkbox"==a(this).prop("type")?a(this).is(":checked")&&(c[a(this).data("name")]=a(this).val()):c[a(this).data("name")]=a(this).val()});var e=a("#nonce_add").val();a.ajax({type:"post",dataType:"json",url:admin_ghn_array.ajaxurl,data:{action:"add_hubs",data:c,nonce:e},context:this,beforeSend:function(){a(".spinner",b).addClass("is-active"),a(".ghn_msg",b).html(""),f=!0},success:function(c){c.success?(a(".ghn_msg",b).html(c.data).fadeIn(),location.reload()):alert(c.data),a(".spinner",b).removeClass("is-active"),f=!1}})}return!1}),a(".devvn_ghn_addhub").on("click",function(){return a(".add_hub_popup").bPopup({closeClass:"close_popup"}),a(".hub_DistrictID").length>0&&a(".hub_DistrictID").select2(),!1}),a(".ghn_creat_order_ajax").on("click",function(){var b=a(this).data("orderid");return a.ajax({type:"post",dataType:"json",url:admin_ghn_array.ajaxurl,data:{action:"ghn_creat_order_ajax",orderid:b},context:this,beforeSend:function(){a(this).addClass("devvn_ghn_loading")},success:function(c){a(this).removeClass("devvn_ghn_loading"),c.success?(a("#ajax_wrap_"+b+" .devvn_hubs_table tbody").html(c.data.result_html),a("#ajax_wrap_"+b+' input[name="ghn_services"]:checked').trigger("change"),a("#ajax_wrap_"+b).bPopup({closeClass:"close_popup",onClose:function(){a("#ajax_wrap_"+b+" .devvn_hubs_table tbody").html("")}}),a("#ghn_creatorder_hub").length>0&&a("#ghn_creatorder_hub").select2()):alert("Your vote could not be added")},error:function(){a(this).removeClass("devvn_ghn_loading"),alert("Error!")}}),!1}),a(".khuvuc_banhang").on("click",function(){var b=a(this).data("hubid");return a("#hub_district_"+b).bPopup({closeClass:"close_popup"}),!1});var g=!1;a(".devvn_ghn_addhubdistrict").on("click",function(){if(g)return!1;var b=a(this).closest("table.devvn_hubs_table"),c=a(this).data("hubid"),d=a("#nonce_update").val(),e=[];return a('input[name="hubs_district_'+c+'"]').each(function(){a(this).is(":checked")&&e.push(a(this).val())}),a.ajax({type:"post",dataType:"json",url:admin_ghn_array.ajaxurl,data:{action:"add_hubdistrict",hubid:c,districtID:e,nonce:d},context:this,beforeSend:function(){g=!0,a(".spinner",b).addClass("is-active"),a(".ghn_msg",b).html("")},success:function(c){c.success?a(".ghn_msg",b).html(c.data).fadeIn():alert(c.data),setTimeout(function(){a(".ghn_msg",b).fadeOut(400,function(){a(this).html("")})},3e3),a(".spinner",b).removeClass("is-active"),g=!1},error:function(){a(".spinner",b).removeClass("is-active"),a(".ghn_msg",b).html(""),g=!1}}),!1}),a(".devvn_checkbox_all").on("click",function(){var b=a(this).closest("table");return a('input[type="checkbox"]:checked',b).length>0?a('input[type="checkbox"]',b).prop("checked",!1):a('input[type="checkbox"]',b).prop("checked",!0),!1}),a("body").on("change",'input[name="ghn_services"]',function(){var b=a(this).closest(".ghn_creat_popup"),c=a(".ghn_all_phuphi",b),d=a(".ghn_all_phuphi_list",c),e=d.data("phuphichoose");c.removeClass("ghn_show");var f=a(this).closest(".ghn_all_goicuoc_list"),g=f.data("extras");if(g.length>0){var h="";a(g).each(function(b,c){var d="";h+='<div class="ghn_all_goicuoc_list">',a(e).each(function(a,b){b.ServiceID==c.ServiceID&&(d='checked="checked"')}),h+='<div class="ghn_all_goicuoc_col"><label><input type="checkbox" name="ghn_extras[]" value="'+c.ServiceID+'" '+d+"> "+c.Name+" </label></div>",h+="</div>"}),c.addClass("ghn_show"),d.html(h)}k(b),m(b)}),a(window).load(function(){a('body input[name="ghn_services"]:checked').trigger("change")}),a("body").on("change",'input[name="ghn_extras[]"], .ghn_isPickAtStation, #ghn_CouponCode',function(){var b=a(this).closest(".ghn_creat_popup");m(b)});var h=!1;a(".ghn_creat_order_popup, .ghn_update_order").on("click",function(){return a(".ghn_creat_popup").bPopup({closeClass:"close_popup"}),a("#ghn_customer_infor_khuvuc").length>0&&a("#ghn_customer_infor_khuvuc").select2(),a("#ghn_customer_infor_ward").length>0&&a("#ghn_customer_infor_ward").select2(),a("#ghn_creatorder_hub").length>0&&a("#ghn_creatorder_hub").select2(),a("#ghn_ghichu_required").length>0&&a("#ghn_ghichu_required").select2(),a('body input[name="ghn_services"]:checked').trigger("click"),!1}),a("body").on("select2:select","#ghn_creatorder_hub",function(b){var c=a(this).closest(".ghn_creat_popup"),d=b.params.data.id;return $args=[],$args.hubID=d,j($args,c),!1}),a("body").on("change","#ghn_order_weight,  #ghn_order_length, #ghn_order_width, #ghn_order_height, #ghn_InsuranceFee",function(){var b=a(this).closest(".ghn_creat_popup"),c=a("#ghn_creatorder_hub").val();return $args=[],$args.hubID=c,j($args,b),!1}),a("body").on("click",".devvn_ghn_creat_order, .devvn_ghn_update_order",function(){var b=a(this).closest(".ghn_creat_popup"),c=a(".allow_creat_order",b).val();if(1==c){var d=a("#ghn_ShippingOrderID",b).val()||0,e=a("#ghn_OrderCode",b).val()||0,f=a(this).closest("tr"),g=a("#ghn_action_nonce").val();g||(g=b.data("nonce"));var j=a(".order_id",b).val(),k=a(".ghn_PaymentTypeID:checked",b).val(),l=a("#ghn_creatorder_hub",b).val(),m=a("#ghn_ghichu",b).val(),n=a("#ghn_tienthuho",b).val(),o=a("#ghn_ghichu_required",b).val(),p=a("#ghn_InsuranceFee",b).val(),q=a('input[name="ghn_services"]:checked',b).val();if(!q)return alert("H\xe3y ch\u1ecdn d\u1ecbch v\u1ee5 giao h\xe0ng!"),!1;var r=a("#ghn_contentOrder",b).val(),s=a("#ghn_CouponCode",b).val(),t=a("#ghn_ExternalCode",b).val(),u=a("#ghn_order_weight",b).val(),v=a("#ghn_order_length",b).val(),w=a("#ghn_order_width",b).val(),x=a("#ghn_order_height",b).val(),y=a(".ghn_isPickAtStation:checked",b).val(),z=!1,A=[];a('input[name="ghn_extras[]"]:checked',b).each(function(b){A[b]=a(this).val(),16==a(this).val()&&(z=!0)}),1==y&&A.push("53337"),z||(p=0);var B="ghn_creat_order";d&&e&&(B="ghn_update_order"),h||a.ajax({type:"post",dataType:"json",url:admin_ghn_array.ajaxurl,data:{action:B,post_ID:j,ghn_ShippingOrderID:d,ghn_OrderCode:e,PaymentTypeID:k,hubID:l,noteOrder:m,CoDAmount:n,noteCode:o,nonce:g,ExternalCode:t,InsuranceFee:p,ghn_services:q,ghn_contentOrder:r,ghn_CouponCode:s,ghn_order_weight:u,ghn_order_length:v,ghn_order_width:w,ghn_order_height:x,ghn_extras:A},context:this,beforeSend:function(){a(".ghn_msg",f).html(""),i()},success:function(b){if(b.success)a(".ghn_msg",f).html(b.data.result_html),a(".ghn_ordercode_html_wrap_"+j).html(b.data.ordercode_html),"ghn_update_order"!=B&&(a("#ajax_wrap_"+j).remove(),a(".b-modal").remove());else{var c=b.data;alert(c.replace(/\\n/g,"\n"))}i(!1)},error:function(){a(".ghn_msg",f).html(""),i(!1)}})}return!1}),a("body").on("change click",".ghn_PaymentTypeID",function(){var b=a(this).closest(".ghn_creat_popup");k(b)}),a("body").on("click",".ghn_cancel_order",function(){var b=a(this).data("ordercode"),c=a("#ghn_action_nonce").val(),d=a("#post_ID").val();return h||a.ajax({type:"post",dataType:"json",url:admin_ghn_array.ajaxurl,data:{action:"ghn_cancel_order",ordercode:b,post_ID:d,nonce:c},context:this,beforeSend:function(){i()},success:function(a){var b=a.data;a.success?(alert(b.replace(/\\n/g,"\n")),location.reload()):alert(b.replace(/\\n/g,"\n")),i(!1)},error:function(){i(!1)}}),!1}),a(".ghn_tracking_order").on("click",function(){var b=a(this).data("ordercode"),c=a("#ghn_action_nonce").val(),d=a("#post_ID").val();return h||a.ajax({type:"post",dataType:"json",url:admin_ghn_array.ajaxurl,data:{action:"ghn_tracking_order",ordercode:b,post_ID:d,nonce:c},context:this,beforeSend:function(){i()},success:function(b){var c=b.data;if(b.success){var d=c.replace(/\\n/g,"\n");a(".ajax_status_tracking").html(d),alert(d)}else alert(c.replace(/\\n/g,"\n"));i(!1)},error:function(){i(!1)}}),!1}),a("body .dhn_change_webhook_url").on("click",function(){var b=l(),c=a("#webhook_url"),d=c.data("webhookaction");return c.val(d+b),a("#webhook_hash").val(b),!1}),a("body .ghn_register_webhook").on("click",function(){var b=a(this).closest("form"),c=a("#webhook_url",b).val(),d=a(this).data("nonce");return h||a.ajax({type:"post",dataType:"json",url:admin_ghn_array.ajaxurl,data:{action:"ghn_set_webhook",webhook_url:c,nonce:d},context:this,beforeSend:function(){b.addClass("devvn_ghn_loading"),i()},success:function(c){var d=c.data;b.removeClass("devvn_ghn_loading"),c.success?a(".webhook_mess").html(d).fadeIn(400,function(){a(".ghn_webhook_url #submit").trigger("click")}):alert(d.replace(/\\n/g,"\n")),i(!1)},error:function(){i(!1),b.removeClass("devvn_ghn_loading")}}),!1}),a("body").on("click",".devvn_option_col_title",function(){var b=a(this).parent(),c=a(".ghn_more_content",b),d=a("small",this);c.is(":visible")?(c.slideUp(),d.html("Xem th\xeam")):(c.slideDown(),d.html("\u1ea8n b\u1edbt"))})})}(jQuery);